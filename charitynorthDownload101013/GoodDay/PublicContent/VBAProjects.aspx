<%@ Page Title="VBA Projects" Language="C#" MasterPageFile="~/Goodday/MasterPage.master" AutoEventWireup="true" CodeFile="VBAProjects.aspx.cs" Inherits="PublicContent_VBAProjects" %>

<asp:Content ID="Content1" ContentPlaceHolderID="headCodeBlock" Runat="Server">
</asp:Content>

<asp:Content ID="Content2" ContentPlaceHolderID="headercontent" Runat="Server" >
</asp:Content>
<asp:Content ID="Content3" ContentPlaceHolderID="bodycontent" Runat="Server">
  <div class="WordSection1">

  <h5 style='margin-left:.5in'>Code Samples:</h5>

  <h5 style='margin-left:.8in;text-indent:-.25in;line-height:normal'><span
  style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><a href="#VBADevelopment">VBA Development</a>.</h5>

  <h5 style='margin-left:.8in;text-indent:-.25in;line-height:normal'><span
  style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><a href="#QuoteTakeoffApplication">Quote-Takeoff Application</a>.</h5>

  <h5 style='margin-left:.8in;text-indent:-.25in;line-height:normal'><span
  style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><a href="#ScheduleBoardApplication">Schedule Board Application</a>.</h5>

  <h5 style='margin-left:.8in;text-indent:-.25in;line-height:normal'><a
  name="_Design."></a><span style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><a href="#Design">Design</a>.</h5>

  <h5 style='margin-left:.8in;text-indent:-.25in;line-height:normal'><span
  style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><a href="#ApplicationOpen">Application.Open</a>.</h5>

  <h5 style='margin-left:.8in;text-indent:-.25in;line-height:normal'><span
  style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><a href="#UsingProcedures">Using Procedures</a>.</h5>

  <h5 style='margin-left:.8in;text-indent:-.25in;line-height:normal'><span
  style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><a href="#Parsing">Parsing</a>.</h5>

  <h5 style='margin-left:.8in;text-indent:-.25in;line-height:normal'><a
  name="_Find.Text."></a><span style='font-family:Symbol'>·<span
  style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><a href="#FindText">Find.Text</a>.</h5>

  <h5 style='margin-left:.8in;text-indent:-.25in;line-height:normal'><span
  style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><a href="#RetrievingData">Retrieving  Data</a>.</h5>

  <h5 style='margin-left:.8in;text-indent:-.25in;line-height:normal'><span
  style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><a href="#DataServers">Data Servers</a>.</h5>

  <h5 style='margin-left:.8in;text-indent:-.25in;line-height:normal'><span
  style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><a href="#OutlookMapiFolders">Outlook MAPIFolders</a>.</h5>

  <h5 style='margin-left:.8in;text-indent:-.25in;line-height:normal'><span
  style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><a href="#DataTransfer">Data Transfer</a>.</h5>

  <h5 style='margin-left:.8in;text-indent:-.25in;line-height:normal'><a
  name="_Schedule_Board."></a><span style='font-family:Symbol'>·<span
  style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><a href="#ScheduleBoard">Schedule Board</a>.</h5>

  <h5 style='margin-left:.8in;text-indent:-.25in;line-height:normal'><span
  style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><a href="#ScheduleBoardWebpage">Schedule Board Webpage</a>.</h5>

  <h5 style='margin-left:.8in;text-indent:-.25in;line-height:normal'><span
  style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><a href="#AspNet">ASP.NET Framework</a>. </h5>

  <h5 style='margin-left:.8in;text-indent:-.25in;line-height:normal'><span
  style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><a href="#JavaScript">JavaScript</a>. </h5>

  <h5 style='margin-left:.8in;text-indent:-.25in;line-height:normal'><span
  style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><a href="#CSSFormating">CSS Formatting</a>. </h5>

  <h5 style='margin-left:.8in;text-indent:-.25in;line-height:normal'><span
  style='font-family:Symbol'>·<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
  </span></span><a href="#FTPAssembly">FTP Assembly</a>. </h5>

  <p class="MsoNoSpacing">&nbsp;</p>

  <p class="MsoNormal"><a name='VBADevelopment'><br /><span class='Heading5Char'>VBA
  Development</span></a><b>.</b> This document shows details of the tools and
  techniques used to develop office automation applications. These projects
  consist of four main parts: Quote (Word VBA), Takeoff (Excel VBA), Schedule
  Board (Outlook VBA), and Schedule Webpage (Visual Studio .NET). Over 20,000
  lines of code were written for these projects. A description of each application's functionality with code snippets follows. </p>

  <p class="MsoNormal"><a name='QuoteTakeoffApplication'><br/><span class='Heading5Char'>Quote-Takeoff
  Application</span></a><span class='Heading2Char'><span style='font-size:13.0pt;
  line-height:115%'>.</span></span> This application was designed and developed for quoting construction jobs. The application uses MS Word as the user interface
  with MS Excel as the data source. The pairing of these office applications is
  done to provide the end users with a familiar interface. </p>

  <p class="MsoNormal"><a name='ScheduleBoardApplication'><br/><span class='Heading5Char'>Schedule
  Board Application</span></a><b>.</b> Outlook is used for the scheduling and
  resource assignment. Outlook is extended with a time -line type of interface
  allowing the user to add, edit and delete tasks directly on the graphical interface.
  In addition, a webpage is provided for access to the Schedule Board when out of
  the office. The webpage has full schedule update functionality, with
  authorization security (username-password) features.</p>

  <p class="MsoNormal"><a name='Design'><br/><span class='Heading5Char'>Design</span></a><b>.</b>
  Office automation with VBA exposes in Word, the Excel object library. VBA
  procedures using Excel objects and saved in the Excel Project are callable in
  the Word Project, by setting the relevant References in the VBIDE. By setting
  References to a dynamic-link libraries (DLL) through a type library (TLB), a
  developer has access to functions in many DLLs, including custom assemblies written
  with Visual Studio in C+ (and most other languages). However, not all DLLs
  proved type libraries. The DLLs that form the Windows API do not provide type
  libraries. To call a function in the Windows API,  a Declare statement is used
  to load the DLL. Here is an example of the Declare statement for the GetComputerName
  function:</p>

  <p class="MsoNoSpacing" ><span class='CODE'><span
  style='font-size:10.0pt'>Private Declare Function GetComputerName Lib
  &quot;kernel32&quot; _</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>Alias &quot;GetComputerNameA&quot; (ByVal lpBuffer As
  String, nSize As Long) As Long</span></span></p>

  <p class="MsoNoSpacing"  >&nbsp;</p>

  <p class="MsoNormal">When a TLB is provided, the controls of an object library are
   exposed by setting the References in the VBIDE. In the VBIDE, selecting the 
  Tools&gt;References Menu bring s up a dialog box listing the TLB name for the
  available DLLs. Here is an image of the dialog box: </p>

  <table  
   style='border-collapse:collapse;border:none'>
   <tr>
    <td width="319" valign="top" style='width:239.4pt;padding:0in 5.4pt 0in 5.4pt'>
    <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
    normal'><a name='ApplicationOpen'><br/><span class='Heading5Char'>Application.Open</span><b>.</b>
    After setting the References, the next step in an automation project is
    opening one application from another. Before a documents can be opened, an
    the application must be loaded. This example first tries to access Excel. If
    an error is thrown, then the Excel application is loaded. After Excel is
    activated, the VBAUtility.xlsm workbook is opened. The workbook is opened,
    but not visible to the user (oExcel.Visible= False).</a></p>
    <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
    normal'><br/><span class='Heading5Char'>&nbsp;</span></p>
    </td>
    <td width='319' valign='top' style='width:239.4pt;padding:0in 5.4pt 0in 5.4pt'>
    <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
    normal'>
      <img alt="" width='335' height='288' src="../Images/VBAProjectsImages/image001.jpg"
    align='left' hspace='12'/></p>
    </td>
   </tr>
   <tr>
    <td width='319' valign='top' style='width:239.4pt;padding:0in 5.4pt 0in 5.4pt'>
    <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
    normal'><span class='Heading5Char'>&nbsp;</span></p>
    </td>
    <td width='319' valign='top' style='width:239.4pt;padding:0in 5.4pt 0in 5.4pt'>
    <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
    normal'><span class='Heading5Char'>&nbsp;</span></p>
    </td>
   </tr>
  </table>

  <p class="MsoNoSpacing"><span class='CODE'><b><span style='font-size:10.0pt'>Sub
  OpenExcel</span></b></span><span class='CODE'><span style='font-size:10.0pt'>()</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  Dim
  oExcel as Excel.Application</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  Dim oWB
  as Workbook</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  Dim
  workbookPath As String</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  </span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  On
  Error Resume Next</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  Set oExcel
  = GetObject(, &quot;Excel.Application&quot;)</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  If Err
  Then</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>    Set oExcel
  = New Excel.Application</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  End If</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'> 
  workbookPath = ThisDocument.path &amp; &quot;\VBAUtility.xlsm&quot;</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>&nbsp;</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  Set oWB
  = oExcel.Workbooks.Open(workbookPath)</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  oExcel.<b>Visible
  = False</b></span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  </span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>End Sub</span></span></p>

  <b><span style='font-size:11.0pt;line-height:115%;font-family:"Calibri","sans-serif"'><br
  clear='all' style='page-break-before:always'/>
  </span></b>

  <p class="MsoNormal"><a name='UsingProcedures'><br/><span class='Heading5Char'>Using
  Procedures</span></a><b>.</b> Once an application is referenced and opened,
  then all the objects and procedures of that application are available. For
  example, in Word, once Excel is referenced and a workbook is opened, then all
  the procedures in that workbook can be called from Word. In this example, a
  list of items from an Excel listbox is parsed, then a procedure called, Call <b>ExportVBComponent</b>(VBComp,
  folderName, ProcName) to populate a Word listbox.</p>

  <p class="MsoNoSpacing"  >&nbsp;</p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>Public <b>Sub
  viewSelectedItemExcel</b>(ByVal FileToGet As String)</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt;
  color:green'>'view selected item</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>Initialize:</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  Dim
  oExcel As Excel.Application</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  Dim oWb
  as Workbook  </span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  Dim
  ProcName As String  </span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  Dim
  compString As String</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  Dim
  folderName As String</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  Dim
  fileName As String</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  Dim I
  As Long</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  Dim S
  As String</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  </span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt;
  color:green'>  'open Excel VBIDE to view procedure</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  On
  Error Resume Next</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  Set oExcel
  = GetObject(, &quot;Excel.Application&quot;)</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  If Err
  Then</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>    Set oExcel
  = New Excel.Application</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  End If</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  </span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>On Error
  GoTo ErrorHandler  </span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>Set oWb =
  oExcel.Workbooks.Open(FileToGet)</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  oWb.Windows(1).Visible
  = False</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  Set
  VBProj = oWb.VBProject</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>&nbsp;</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>Main:</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt;
  color:green'>  'parse selected item for procedure name</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  On
  Error Resume Next</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'> 
  folderName = Documents(&quot;VBAUtility.docm&quot;).path &amp;
  &quot;\VBAModules\VBAModulesExcel&quot;</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  Dim
  columnNumber As Long</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'> 
  columnNumber = 0</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  With
  ControlPanel.ProcedureListBox</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>    For I
  = 0 To .ListCount - 1</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>      If
  .Selected(I) Then</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>        S
  = .List(I, columnNumber)</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>       
  compString = Left(S, InStr(S, &quot;:&quot;) - 1)</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>       
  Set VBComp = VBProj.VBComponents(compString)</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>       
  If VBComp Is Nothing Then fileName = compString &amp; &quot;.doc&quot;</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>      </span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>       
  ProcName = Right(S, Len(S) - (InStr(S, &quot;:&quot;) + 1))</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>       
  ProcName = Left(ProcName, InStr(ProcName, &quot;,&quot;) - 1)</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>        </span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt;
  color:#006600'>        'call sub to show selected Excel procedure in Word</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>       
  Call <b>ExportVBComponent</b>(VBComp, folderName, ProcName)</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>       
  Exit Sub</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>      End
  If</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>    Next
  I</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  End
  With</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  </span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>Cleanup:</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  Set
  VBProj = Nothing</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  Set
  VBComp = Nothing</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'> 
  compString = vbNullString</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  Exit
  Sub</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>&nbsp;</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>ErrorHandler:</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  MsgBox
  &quot;An error occurred while processing 'viewSelectedItemExcel'.&quot;</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  Resume
  Cleanup</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>End Sub</span></span></p>

  <p class="MsoNormal">&nbsp;</p>

  <p class="MsoNormal"><a name='Parsing'><br/><span class='Heading5Char'>Parsing</span></a><b>.</b>
  In most automation projects, parsing strings is required. Parsing is used to
  retrieve the part of string needed for the task at hand. In the previous
  snippet, each item of a Excel listbox is parsed to find the procedure name
  (ProcName), then that ProcName is used as an argument in the
  ExportVBComponent() function to populate Word listbox. The string functions:
  Left, Right, Len, InStr and InStrRev are four of the most useful functions for
  parsing. </p>

  <p class="MsoNormal"><a name='FindText'><br/><span class='Heading5Char'>Find.Text</span></a><b>.</b>
  Finding the string to parse is usually the first step in a parsing procedure.
  The following is an example of finding and concatenating a string to type the
  text into a document.</p>

  <p class="MsoNoSpacing" style='margin-left:.5in'><span class='CODE'><span
  style='font-size:10.0pt'>Sub walkoutCompaction()</span></span></p>

  <p class="MsoNoSpacing" style='margin-left:.5in'><span class='CODE'><span
  style='font-size:10.0pt'>    Dim compactionFound As Boolean</span></span></p>

  <p class="MsoNoSpacing" style='margin-left:.5in'><span class='CODE'><span
  style='font-size:10.0pt'>    With Selection</span></span></p>

  <p class="MsoNoSpacing" style='margin-left:.5in'><span class='CODE'><span
  style='font-size:10.0pt'>        .Find.Text = &quot;compaction&quot;</span></span></p>

  <p class="MsoNoSpacing" style='margin-left:.5in'><span class='CODE'><span
  style='font-size:10.0pt'>        compactionFound = .Find.Execute</span></span></p>

  <p class="MsoNoSpacing" style='margin-left:.5in'><span class='CODE'><span
  style='font-size:10.0pt'>        If compactionFound Then</span></span></p>

  <p class="MsoNoSpacing" style='margin-left:.5in'><span class='CODE'><span
  style='font-size:10.0pt'>          .Extend</span></span></p>

  <p class="MsoNoSpacing" style='margin-left:.5in'><span class='CODE'><span
  style='font-size:10.0pt'>          .EndKey</span></span></p>

  <p class="MsoNoSpacing" style='margin-left:1.0in'><span class='CODE'><span
  style='font-size:10.0pt'>    .TypeText &quot;compaction of inside and” &amp; _</span></span></p>

  <p class="MsoNoSpacing" style='margin-left:1.0in'><span class='CODE'><span
  style='font-size:10.0pt'>    “ outside of walkout and garage areas&quot;</span></span></p>

  <p class="MsoNoSpacing" style='margin-left:.5in'><span class='CODE'><span
  style='font-size:10.0pt'>        Else</span></span></p>

  <p class="MsoNoSpacing" style='margin-left:.5in'><span class='CODE'><span
  style='font-size:10.0pt'>         .Find.Text = &quot;labour, forms&quot;</span></span></p>

  <p class="MsoNoSpacing" style='margin-left:.5in'><span class='CODE'><span
  style='font-size:10.0pt'>         compactionFound = .Find.Execute</span></span></p>

  <p class="MsoNoSpacing" style='margin-left:.5in'><span class='CODE'><span
  style='font-size:10.0pt'>         .MoveUp Unit:=wdLine, Count:=1</span></span></p>

  <p class="MsoNoSpacing" style='margin-left:.5in'><span class='CODE'><span
  style='font-size:10.0pt'>         .InsertBefore vbCr</span></span></p>

  <p class="MsoNoSpacing" style='margin-left:.5in'><span class='CODE'><span
  style='font-size:10.0pt'>         .EndKey</span></span></p>

  <p class="MsoNoSpacing" style='margin-left:.5in'><span class='CODE'><span
  style='font-size:10.0pt'>         .TypeText &quot;compaction of inside and”
  &amp; _</span></span></p>

  <p class="MsoNoSpacing" style='margin-left:.5in'><span class='CODE'><span
  style='font-size:10.0pt'>         “outside of walkout and garage areas&quot;</span></span></p>

  <p class="MsoNoSpacing" style='margin-left:.5in'><span class='CODE'><span
  style='font-size:10.0pt'>        End If</span></span></p>

  <p class="MsoNoSpacing" style='margin-left:.5in'><span class='CODE'><span
  style='font-size:10.0pt'>    End With</span></span></p>

  <p class="MsoNoSpacing" style='margin-left:.5in'><span class='CODE'><span
  style='font-size:10.0pt'>End Sub</span></span></p>

  <p class="MsoNormal">&nbsp;</p>

  <p class="MsoNoSpacing"  ><a name='RetrievingData'><br /><span
  class='Heading5Char'>Retrieving Data</span></a><b>.</b> Populating a Word
  document from a data source is key to many application. Using automation, Word can
  pull data directly, using Excel object properties. For example, this Word Sub
  retrieves FileToGet = Range(&quot;A1&quot;).Value and populates an array using
  an Excel range, proceduresTable, named programmatically. In addition, an Excel
  user defined function, <b>proceduresCount</b> is Run to determine the number of
  procedures, to  size an array:</p>

  <p class="MsoNoSpacing">&nbsp;</p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>Sub
  proceduresData(Optional ByVal proceduresCount As Long)</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>Initialize:</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt;
  color:green'>  'copy procedures from Excel to populate this Word document</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  On Error
  GoTo ErrorHandler:</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  Const
  procedureName = &quot;proceduresData&quot;</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'> 
  StatusBar = procedureName</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>&nbsp;</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  Dim I
  As Long</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  Dim
  dataArray() As Variant</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  </span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>Main:</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt;
  color:green'>  'run function in Excel to count procedures</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'> 
  proceduresCount = Run(&quot;AutomationModule.<b>proceduresCount</b>&quot;)</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  FileToGet
  = Range(&quot;A1&quot;).Value</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'> 
  'dimension variables with count</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  ReDim
  dataArray(proceduresCount, 2)</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'> 
  Range(&quot;A3:B&quot; &amp; proceduresCount + 2).Name =
  &quot;proceduresTable&quot;</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'> 
  dataArray = Range(&quot;proceduresTable&quot;)</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  </span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  For I =
  1 To UBound(dataArray)</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>    If
  dataArray(I, 1) &lt;&gt; vbNullString Then</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>     
  ControlPanel.ProcedureListBox.AddItem dataArray(I, 1) &amp; _</span></span></p>

  <p class="MsoNoSpacing" style='margin-left:.8in'><span class='CODE'><span
  style='font-size:10.0pt'>&quot;, Lines: &quot; &amp; dataArray(I, 2)</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>    End
  If</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  Next I</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  </span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>Cleanup:</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  'Kill
  dataArray</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  Exit
  Sub</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  </span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>ErrorHandler:</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'> 
  Debug.Print &quot;An error was thrown by &quot; &amp; procedureName &amp; _</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  vbCr
  &amp; Err.Number &amp; &quot;: &quot; &amp; Err.Description</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  Resume
  Cleanup:</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>End Sub</span></span></p>

  <p class="MsoNoSpacing"  >&nbsp;</p>

  <p class="MsoNoSpacing"  ><a name='DataServers'><br /><span
  class='Heading5Char'>Data Servers</span></a><b>.</b> The automation methods
  require that the server application, in this case, Excel be activated. Opening
  a workbook in this way is slow. It can be faster to use an ADO recordset to
  retrieve data. Similar methods of data retrieval are implemented for most  database
  management systems  (DBMS). This example is a function that returns a variant
  array populated by an ADODB.recordset, retrieved from Excel . In the SQL Select
  statement, the From clause uses a variable, sectionName, containing a name
  range, in place of a table name, as is used with other databases. </p>

  <p class="MsoNoSpacing"  >&nbsp;</p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>Function
  recordsetArray(ByVal sectionName As String) As Variant</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  Dim cn
  As New ADODB.Connection</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  Dim rs
  As ADODB.Recordset</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  Dim
  arrRecordArray() As Variant</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  Dim
  newPath As String</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  newPath
  = ThisDocument.Path</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  With cn</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>   
  .Provider = &quot;MSDASQL&quot;</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>   
  .ConnectionString = &quot;Driver={Microsoft Excel Driver (*.xls)};&quot; &amp;
  _</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>     
  &quot;DBQ=&quot; &amp; newPath &amp; &quot;\TakeoffTables.xls; &quot;</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>    .CursorLocation
  = CursorLocationEnum.adUseClient</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>    .Open</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  End
  With</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>   
  sectionName = &quot;selected&quot; &amp; sectionName</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>    On
  Error Resume Next</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>    Set
  rs = cn.Execute(&quot;SELECT * FROM &quot; &amp; sectionName &amp; _</span></span></p>

  <p class="MsoNoSpacing" style='margin-left:.5in'><span class='CODE'><span
  style='font-size:10.0pt'>  &quot; WHERE Count &lt;&gt; null&quot;)</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>    </span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt;
  color:green'>  ‘populate Array.</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  arrRecordArray
  = rs.GetRows</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'> 
  recordsetArray = arrRecordArray</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>End
  Function</span></span></p>

  <p class="MsoNormal">&nbsp;</p>

  <p class="MsoNormal"><a name='OutlookMapiFolders'><br/><span class='Heading5Char'>Outlook
  MAPIFolders</span></a><b>.</b> Microsoft Outlook is significantly different
  from Word or Excel. The Outlook object model is generally used to access items
  in folders. The first step in many procedures is to get the appropriate folder.
  There are 16 standard Outlook MAPIFolders. The following example gets the
  olFolderCalendar folder. The items in this folder are the calendar items. This
  procedure filters items for a range of dates. The properties of each item are
  exposed. In the follow code the item properties are read into an array for used
  by other procedures.</p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt;
  color:green'>'this procedure gets the Scheduled Calendar Items from Outlook</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>Function
  jobtasksArray(Optional ByRef Cancelled As Boolean) As Variant()</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  Dim
  olnameSpace As Outlook.NameSpace</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  Dim fld
  As Outlook.MAPIFolder</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  Dim
  itms As Outlook.Items</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  Dim
  ritms As Outlook.Items</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  Dim
  lngCount As Long</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  Dim
  strStartDate As String</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  Dim
  dteEnd As Date</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  Dim
  strDateRange As String</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  Dim
  strEndDate As String</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  Dim I
  As Integer</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  </span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  Set
  olnameSpace = Application.GetNamespace(&quot;MAPI&quot;)</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  Set fld
  = olnameSpace.GetDefaultFolder(9) 'olFolderCalendar</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  Set
  itms = fld.Items</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>      </span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'> 
  startDateForm.Show</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'> 
  strStartDate = startDateForm.startDateTextBox.Value</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  If
  startDateForm.startDateTextBox.Value = &quot;cancel&quot; Then</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>   
  Cancelled = True</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>   
  controlPanel.Hide</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>    Exit
  Function</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  End If</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  If
  strStartDate = &quot;&quot; Then</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>   
  greenBoard.Hide</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>   
  dteStart = 0</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>    Exit
  Function</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  End If</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'> 
  dteStart = CDate(strStartDate)</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  GoTo
  endDate</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  </span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  </span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>endDate:</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  dteEnd
  = dteStart + 14</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  </span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>CreateFilter:</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt;
  color:green'>  'Create date range string</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'> 
  strStartDate = dteStart &amp; &quot; 12:00 AM&quot;</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'> 
  strEndDate = dteEnd &amp; &quot; 11:59 PM&quot;</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'> 
  strDateRange = &quot;[Start] &gt;= &quot;&quot;&quot; &amp; strStartDate &amp;
  _</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>     
  &quot;&quot;&quot; and [Start] &lt;= &quot;&quot;&quot; &amp; strEndDate &amp;
  &quot;&quot;&quot;&quot;</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  </span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'> 
  dateRangeCaption = DateValue(strStartDate) &amp; &quot; - &quot; &amp;
  DateValue(strEndDate)</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'> 
  itms.IncludeRecurrences = True</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'> 
  itms.Sort Property:=&quot;[Start]&quot;, Descending:=False</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  </span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  If
  strDateRange &lt;&gt; &quot;&quot; Then</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>    Set
  ritms = itms.Restrict(strDateRange)</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>   
  ritms.Sort Property:=&quot;[Start]&quot;, Descending:=False</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  </span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>    'Get
  an accurate count</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>    'this
  is where all the filtered items are accessed</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>   
  lngCount = 0</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>    For
  Each itm In ritms</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>       
  lngCount = lngCount + 1</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>    Next
  itm</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  Else</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>    Set
  ritms = itms</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  End If</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  numberScheduledTasks
  = lngCount</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  </span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt;
  color:green'>  'here we store all Calendar items that start between the dates
  input and</span></span><span class='CODE'><span style='font-size:10.0pt'> <span
  style='color:green'>their key parameters</span></span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  ReDim
  itemArray(lngCount, 9)</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  Dim
  workdayStart As Date</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  I = 0</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  For
  Each itm In ritms</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>    I = I
  + 1</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>   
  itemArray(I, 1) = itm.Subject</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>   
  itemArray(I, 2) = itm.Start</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>   
  itemArray(I, 3) = itm.End</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>   
  itemArray(I, 4) = itm.Duration</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>   
  itemArray(I, 5) = itm.Categories</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>   
  itemArray(I, 6) = itm.RequiredAttendees</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>   
  itemArray(I, 7) = itm.Body</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt;
  color:green'>    'workdayStart, 7 am, for the day the item is schedule for</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>   
  workdayStart = DateAdd(&quot;h&quot;, 7, DateValue(itm.Start))</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt;
  color:green'>    'minutes between workdayStart, 7 am, and JobTask start</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>   
  itemArray(I, 8) = dateDiff(&quot;n&quot;, workdayStart, itm.Start)</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt;
  color:green'>    'days between filter Date range and JobTaks start</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>    itemArray(I,
  9) = dateDiff(&quot;d&quot;, dteStart, itm.Start)</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt;
  color:green'>    'work backwards from minutes offset for jobTask to find the
  Time</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>    Dim
  startTime As Date</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>   
  startTime = DateAdd(&quot;n&quot;, itemArray(I, 8), workdayStart)</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  Next
  itm</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  </span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt;
  color:green'>  'add two more column to the itemArray for color code and
  jobNumber</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  ReDim
  Preserve itemArray(lngCount, 9)</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  </span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt;
  color:green'>  'this is the array with all the job tasks and the 9 parameters
  needed</span></span><span class='CODE'><span style='font-size:10.0pt'> for
  taskControls</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  On
  Error GoTo ErrorHandlerExit</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'> 
  jobtasksArray = extendedArray</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  </span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>ErrorHandlerExit:</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  Exit
  Function</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  </span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>ErrorHandler:</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  MsgBox
  prompt:=&quot;Error No: &quot; &amp; Err.Number &amp; &quot;; Description:
  &quot; &amp; _</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>   
  Err.Description, _</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>   
  Buttons:=vbOKOnly + vbCritical, _</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>   
  Title:=&quot;Error Getting Calendar&quot;</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  Resume
  ErrorHandlerExit</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>  </span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>End
  Function</span></span></p>

  <p class="MsoNormal">&nbsp;</p>

  <p class="MsoNormal">Here the olFoldersContacts is used to populate a listbox for
  the user to make a resource selection.</p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>Sub
  contactsList()</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>    Dim
  myNamespace As Outlook.NameSpace</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>    Dim
  myContacts As Outlook.Items</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>    Dim
  myItems As Outlook.Items</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>    Dim
  myItem As Object</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>    </span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>    Set
  myNamespace = Application.GetNamespace(&quot;MAPI&quot;)</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>    Set
  myContacts = myNamespace.GetDefaultFolder(olFolderContacts).Items</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>    </span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>    Set
  myItems = myContacts</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>    For
  Each myItem In myItems</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>       
  If (myItem.Class = olContact) Then</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>           
  taskAppointmentForm.contactsComboBox.<b>AddItem</b> myItem.fullName</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>       
  End If</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>    Next</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>End Sub</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>&nbsp;</span></span></p>

  <p class="MsoNormal"><a name='DataTransfer'><br/><span class='Heading5Char'>Data Transfer</span></a><b>.</b>
  In this example, the contacts are imported from Excel using a DAO.Database.Recordset.
  The SQL Select statement uses an Excel named range in place of a table name in
  the From clause. The MAPIFolder used is the  olFolderContacts.</p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt;color:#006600'>'this code get the Contacts from Excel</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>Sub transferContacts()</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>&nbsp;</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>OpenConnectionToExcel:</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>  Dim db As DAO.Database</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>  Dim rs As DAO.Recordset</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>  Dim contactsFile As String</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>  Dim iRecord As Long</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>  contactsFile = relativePathModule.myPath &amp;
  &quot;\My Projects\Project.Scheduler\contacts.xls&quot;</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>  Set db = OpenDatabase(Name:=contactsFile,
  Options:=False, ReadOnly:=False, Connect:=&quot;Excel 8.0&quot;)</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>  Set rs = db.OpenRecordset(&quot;SELECT * FROM
  `conactsTable` WHERE firstName &lt;&gt; null&quot;)</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>  Dim totalCount As Long</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>  rs.MoveLast</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>  totalCount = rs.recordCount</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>  rs.MoveFirst</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>  </span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>&nbsp;</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>CreateContactItems:</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>  On Error Resume Next</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>  Dim myNamespace As Outlook.NameSpace</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>  Dim myFolder As Outlook.Folder</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>  Dim myItem As Outlook.ContactItem</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>  Dim fullName As String</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>&nbsp;</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>  Set myNamespace = Application.GetNamespace(&quot;MAPI&quot;)</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>  Set myFolder =
  myNamespace.GetDefaultFolder(olFolderContacts)</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>  Set myItem = myFolder.Items.Add</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>&nbsp;</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>  While Not rs.EOF</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>    Set myItem = Outlook.CreateItem(olContactItem)</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>  </span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>    fullName = rs.Fields(3).Value &amp; &quot;, &quot;
  &amp; rs.Fields(1).Value</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>    Call findName(fullName) 'check for duplicates</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>  </span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>    myItem.FileAs = rs.Fields(3).Value &amp; &quot;,
  &quot; &amp; rs.Fields(1).Value</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>    myItem.LastName = rs.Fields(3).Value</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>    myItem.FirstName = rs.Fields(1).Value</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>    myItem.CompanyName = rs.Fields(5).Value</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>    myItem.BusinessAddress = rs.Fields(8).Value</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>    myItem.MobileTelephoneNumber = rs.Fields(40).Value</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>    myItem.BusinessTelephoneNumber =
  rs.Fields(31).Value</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>    myItem.HomeTelephoneNumber = rs.Fields(37).Value</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>    myItem.Email1Address = rs.Fields(57).Value</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>    myItem.Email1DisplayName = rs.Fields(59).Value</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>    iRecord = iRecord + 1</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>    If iRecord &gt; totalCount Then GoTo ErrorHandler 
  'stop loop if count exceeds total records spreadsheet</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>    myItem.Save</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>    rs.MoveNext</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>  Wend</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>  MsgBox prompt:=&quot;Import Complete: &quot; &amp;
  iRecord, _</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>  Buttons:=vbOKOnly + vbInformation, _</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>  Title:=&quot;Import Contacts&quot;</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>      </span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>ErrorHandlerExit:</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>   GoTo ExitSub</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>ErrorHandler:</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>  MsgBox prompt:=&quot;Error No: &quot; &amp;
  Err.Number &amp; &quot;; Description: &quot;, _</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>    Buttons:=vbOKOnly + vbCritical, _</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>    Title:=&quot;Import Appointments&quot;</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>&nbsp;</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>  Resume ErrorHandlerExit</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>ExitSub:</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>  rs.Close</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>  db.Close</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>  Set rs = Nothing</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>  Set db = Nothing</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>End Sub</span></span></p>

  <p class="MsoNoSpacing">&nbsp;</p>

  <table  
   style='border-collapse:collapse;border:none'>
   <tr>
    <td width='238' valign='top' style='width:178.5pt;padding:0in 5.4pt 0in 5.4pt'>
    <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
    normal'><a name='ScheduleBoard'><br/><span class='Heading5Char'>Schedule Board</span></a><b>.</b>
    The Outlook standard calendar interface is a table, with cells representing
    days. However, Project Schedulers often prefer to view a calendar as a time
    line. The Schedule Board is such a graphical interface. Here is an image:</p>
    <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
    normal'>&nbsp;</p>
    </td>
    <td width='400' valign='top' style='width:300.3pt;padding:0in 5.4pt 0in 5.4pt'>
    <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
    normal'><img alt="" width='383' height='384' src="../Images/VBAProjectsImages/image002.jpg"
    align='left' hspace='12'/></p>
    </td>
   </tr>
  </table>

  <p class="MsoNormal">Each schedule item on the GreenBoard is represented with a
  textbox; there can be hundred of schedule items over a two week period. Controls
  are added to the GreenBoard dynamically. To add controls dynamically, using the
  minimum number lines of code,  Class Modules with EventHandlers are used. The
  following code snippet is in the code behind the GreenBoard. The code calls the
  Class Modules, taskEventHander, which uses mouse events to implement drag and
  drop functionality to the dynamically added textboxes. A label is also added
  dynamically for each schedule task to provide a handle for resizing the control
  (the small red squares in the image). The resizeEventHandler is another Class
  Module, not shown.</p>

  </div>

  <span style='font-size:11.0pt;font-family:"Calibri","sans-serif"'><br
  clear='all' style='page-break-before:auto'/>
  </span>

  <div class='WordSection2'>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt;color:green'>‘this adds a textbox for each scheduled
  item</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>Sub addJobTasks(Optional ByRef Cancelled As Boolean)</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>On Error GoTo ExitSub</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>    Dim taskControl As MSForms.TextBox</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>    Dim resizeControl As MSForms.Label</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>    Dim I As Integer</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>    Dim priorEnd As Integer</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>    Dim priorTop As Integer</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>    priorEnd = 0</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>    </span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt;color:green'>    'the expanded array function adds the
  color code to the jobTasksArray</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt;
  color:green'>'the jobTasksArray function gets Calendar item data to put into
  the</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt;
  color:green'>'jobTasksArray</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt;
  color:green'>'the function gets JobTasks,stores the items in newArray, so that
  don't have to</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt;
  color:green'>'go back to the array 'function</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>    newArray = jobTasksGetModule.jobtasksArray</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt;color:green'>    'If Cancelled Then Exit Sub</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt;color:green'>    'synch Day Labels with start date,
  dteStart</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>    If dteStart = 0 Then Exit Sub</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>    synchDayLabels</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt;color:green'>    'add a textbox for each JobTask</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>    For I = 1 To UBound(newArray(), 1)</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>&nbsp;</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt;color:green'>        'add the textbox controls</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>        Set taskControl = Me.Controls.Add(&quot;forms.textbox.1&quot;,
  &quot;Task&quot; &amp; I, True)</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>         </span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt;color:green'>        'add Task# control to the
  taskControls array</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>        If TypeName(taskControl) = &quot;TextBox&quot;
  Then </span></span></p>

  <p class="MsoNoSpacing" style='margin-left:.5in;text-indent:.5in'><span
  class='CODE'><span style='font-size:10.0pt'>taskControls.Add
  Me.Controls(&quot;Task&quot; &amp; I)</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>    End
  If</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>              </span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt;
  color:green'>  'set the attributes of the new Task control, using newArray as the
  data</span></span><span class='CODE'><span style='font-size:10.0pt'> <span
  style='color:#006600'>source</span></span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>        With taskControl</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>                greenBoard.Caption = &quot;Schedule
  Board &quot; &amp; dateRangeCaption</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>                .Enabled = True</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>                .Height = 24</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>                If newArray(I, 9) = &quot;&quot; Then </span></span></p>

  <p class="MsoNoSpacing" style='margin-left:1.0in;text-indent:.5in'><span
  class='CODE'><span style='font-size:10.0pt'>MsgBox newArray(I, 1) &amp; &quot;
  Color is null.&quot;</span></span></p>

  <p class="MsoNoSpacing"><span class='CODE'><span style='font-size:10.0pt'>           
  End If</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>                .BackColor = newArray(I, 11)</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>                If .BackColor = 0 Then .BackColor =
  newArray(I - 1, 11)</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>                .BorderStyle = 1</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>                .TextAlign = fmTextAlignLeft</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>                .Font.Size = 7</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>                .Font.Bold = True</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>                .WordWrap = True</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>                .MultiLine = True</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>                .ControlTipText = newArray(I, 1)
  '.Subject=1</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>                .Top = 42 + 18 * I  'priorTop</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>                .text = newArray(I, 10) &amp; vbCr
  &amp; newArray(I, 5) </span></span></p>

  <p class="MsoNoSpacing" style='margin-left:1.0in'><span class='CODE'><span
  style='font-size:10.0pt;color:green'>    'jobNumer=8 '.Categories=5</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>                .Width = newArray(I, 4) / 6.25 <span
  style='color:green'>'.Duration</span></span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>                If .Width &lt; 4 Then .Width = 4</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>                .Left = newArray(I, 9) * 96 +
  newArray(I, 8) / 6.25 </span></span></p>

  <p class="MsoNoSpacing" style='margin-left:1.0in'><span class='CODE'><span
  style='font-size:10.0pt;color:#006600'>    'offset from 7 am for the day the
  item is schedule for</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>                If newArray(I, 8) = 0 Then .Left =
  .Left + 2</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>                If newArray(I, 8) = 96 Then .Left =
  .Left - 1</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>                priorEnd = newArray(I, 8) +
  newArray(I, 4)</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>                priorTop = .Top</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>        End With</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>        </span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt;color:green'>        'add a resizeControl for each
  taskControl</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>        Set resizeControl = Me.Controls.Add(&quot;forms.Label.1&quot;,
  &quot;Resize&quot; &amp; I, True)</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt;color:green'>        'add Task# control to the
  taskControls array</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>        If TypeName(resizeControl) = &quot;Label&quot;
  Then </span></span></p>

  <p class="MsoNoSpacing" style='margin-left:.5in;text-indent:.5in'><span
  class='CODE'><span style='font-size:10.0pt'>resizeControls.Add Me.Controls(&quot;Resize&quot;
  &amp; I)</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>        End If</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>        With resizeControl</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>            .Left = Me.Controls(&quot;Task&quot; &amp;
  I).Left + Me.Controls(&quot;Task&quot; &amp; I).Width- 1</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>            .Top = Me.Controls(&quot;Task&quot; &amp;
  I).Top + Me.Controls(&quot;Task&quot; &amp; I).Height - 1</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>            .Width = 5</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>            .Height = 5</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>            .MousePointer = 8</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>            .BackStyle = 1</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>            .BackColor = vbRed</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>            resizeControlsArray(I) = .Name</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>        End With</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>    Next I</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>ExitSub:</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>End Sub</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>&nbsp;</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt;color:green'>'this uses the Class Module
  taskEventHandler to minimize repeating code for each added ‘TaskControl</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>Sub addTasksHandler()</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>    Set taskCollectionOfEventHandlers = New Collection</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>    Dim I As Integer</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>    Dim oControl As Control</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>    Dim oEventHandler As taskEventHandler</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'> </span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>    For Each oControl In Me.Controls    'taskControls,
  textbox</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>        If TypeName(oControl) = &quot;TextBox&quot;
  Then</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>            Set oEventHandler = New taskEventHandler</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>            Set oEventHandler.taskControl = oControl</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>            taskCollectionOfEventHandlers.Add
  oEventHandler</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>        End If</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>    Next oControl</span></span></p>

  <p class="MsoNoSpacing"  ><span class='CODE'><span
  style='font-size:10.0pt'>End Sub</span></span></p>

  </div>

  <span class='CODE'><span style='font-size:10.0pt'><br clear='all' style='page-break-before:
  auto'/>
  </span></span>

  <div class='WordSection3'>

  <table 
   style='border-collapse:collapse;border:none'>
   <tr>
    <td width='319' valign='top' style='width:239.4pt;padding:0in 5.4pt 0in 5.4pt'>
    <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
    normal'><a name='ScheduleBoardWebpage'><br/><span class='Heading5Char'>Schedule Board
    Webpage</span></a><b>.</b> Access to the Scheduler is provide by the <a
    href="http://www.gooddaycorp.com">www.gooddaycorp.com</a> website.  There are
    4 parts to the web. The web form controls, data access code behind,
    JavaScript functionality and CSS formatting. The connection between the
    website and the Schedule Board in Outlook is through a COM assembly built
    with Visual Studio that provides a TLB for easy References.</p>
    <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
    normal'>&nbsp;</p>
    <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
    normal'><a name='AspNet'><br/><span class='Heading5Char'>ASP.NET</span></a><b>.</b>
    Visual Studio was used to develop this website. This ASP.NET website is built
    using ASP.NET 3.5 framework, with C#. The main functionality of the web is
    provided by the DataCalendar assembly by Mike Ellison (2004), downloaded from
    <a href="http://www.codeproject.com/Articles/5347/DataCalendar">The Code
    Project</a>. The site is designed with a MasterPage that contains the links
    to the style pages (<b>CSS Formating</b>), the Membership controls (login)
    and the <b>JavaScript</b>. The content pages contain the web form controls:
    calendar control, a repeater, databound to the calendar and the data source
    connection script. The data source is an Excel file that is transferred to
    the website using an <b>FTP Assembly</b>. The Excel file is populated from
    the Outlook Schedule Board, VBA.</p>
    <p class="MsoNoSpacing"  >&nbsp;</p>
    </td>
    <td width='319' valign='top' style='width:239.4pt;padding:0in 5.4pt 0in 5.4pt'>
    <p class="MsoNoSpacing"  ><img alt="" width='293' height='576'
    src="../Images/VBAProjectsImages/image003.jpg" align='left' hspace='12'/></p>
    </td>
   </tr>
  </table>

  <p class="MsoNoSpacing"  >&nbsp;</p>

  <p class="MsoNormal"><a name='JavaScript'><br/><span class='Heading5Char'>JavaScript</span></a><b>.</b>
  Client side Javascript livens up the webpage by animating the Membership
  controls, to popup, with fade and resizing. The popups are set to grow on the
  screen for 1000 milliseconds, while the background is grays-out. Here is a
  snippet:</p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span class='CODE'><span style='font-size:10.0pt'>function
  greyout(d, z) {</span></span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span class='CODE'><span style='font-size:10.0pt'> 
  var obj = document.getElementById('greyout');</span></span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span class='CODE'><span style='font-size:10.0pt'>&nbsp;</span></span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span class='CODE'><span style='font-size:10.0pt'> 
  if (!obj) {</span></span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span class='CODE'><span style='font-size:10.0pt'>   
  appendElement(document.body, 'div', 'greyout');</span></span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span class='CODE'><span style='font-size:10.0pt'>   
  obj = document.getElementById('greyout');</span></span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span class='CODE'><span style='font-size:10.0pt'>   
  obj.style.position = 'absolute';</span></span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span class='CODE'><span style='font-size:10.0pt'>   
  obj.style.top = '0px';</span></span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span class='CODE'><span style='font-size:10.0pt'>   
  obj.style.left = '0px';</span></span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span class='CODE'><span style='font-size:10.0pt'>   
  obj.style.background = '#111';</span></span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span class='CODE'><span style='font-size:10.0pt'>   
  obj.style.opacity = '.3';</span></span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span class='CODE'><span style='font-size:10.0pt'>   
  obj.style.filter = 'alpha(opacity=30)';</span></span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span class='CODE'><span style='font-size:10.0pt'>  }</span></span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span class='CODE'><span style='font-size:10.0pt'> 
  if (d) {</span></span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span class='CODE'><span style='font-size:10.0pt'>   
  var ch = document.documentElement.clientHeight ?
  document.documentElement.clientHeight : document.body.clientHeight;</span></span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span class='CODE'><span style='font-size:10.0pt'>   
  var cw = document.documentElement.clientWidth ? document.documentElement.clientWidth
  : document.body.clientWidth;</span></span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span class='CODE'><span style='font-size:10.0pt'>   
  var sh = document.documentElement.scrollHeight ?
  document.documentElement.scrollHeight : document.body.scrollHeight;</span></span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span class='CODE'><span style='font-size:10.0pt'>   
  if (document.body.scrollHeight) sh = Math.max(sh, document.body.scrollHeight)</span></span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span class='CODE'><span style='font-size:10.0pt'>   
  var sw = document.documentElement.scrollWidth ?
  document.documentElement.scrollWidth : document.body.scrollWidth;</span></span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span class='CODE'><span style='font-size:10.0pt'>   
  if (document.body.scrollWidth) sh = Math.max(sh, document.body.scrollWidth)</span></span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span class='CODE'><span style='font-size:10.0pt'>   
  var wh = window.innerHeight ? window.innerHeight : document.body.offsetHeight;</span></span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span class='CODE'><span style='font-size:10.0pt'>   
  if (!z) { z = 50 }</span></span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span class='CODE'><span style='font-size:10.0pt'>   
  obj.style.zIndex = z;</span></span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span class='CODE'><span style='font-size:10.0pt'>   
  obj.style.height = Math.max(wh, Math.max(sh, ch)) + 'px';</span></span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span class='CODE'><span style='font-size:10.0pt'>   
  obj.style.width = Math.max(sw, cw) + 'px';</span></span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span class='CODE'><span style='font-size:10.0pt'>   
  obj.style.display = 'block';</span></span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span class='CODE'><span style='font-size:10.0pt'>   
  addEvent(window, 'resize', greyoutResize);</span></span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span class='CODE'><span style='font-size:10.0pt'>  }</span></span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span class='CODE'><span style='font-size:10.0pt'> 
  else {</span></span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span class='CODE'><span style='font-size:10.0pt'>   
  obj.style.display = 'none';</span></span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span class='CODE'><span style='font-size:10.0pt'>   
  removeEvent(window, 'resize', greyoutResize);</span></span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span class='CODE'><span style='font-size:10.0pt'>  }</span></span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span class='CODE'><span style='font-size:10.0pt'>}</span></span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span class='CODE'><span style='font-size:10.0pt'>&nbsp;</span></span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span class='CODE'><span style='font-size:10.0pt'>function
  greyoutResize() {</span></span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span class='CODE'><span style='font-size:10.0pt'> 
  var ch = document.documentElement.clientHeight ?
  document.documentElement.clientHeight : document.body.clientHeight;</span></span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span class='CODE'><span style='font-size:10.0pt'> 
  var cw = document.documentElement.clientWidth ?
  document.documentElement.clientWidth : document.body.clientWidth;</span></span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span class='CODE'><span style='font-size:10.0pt'> 
  var sh = document.documentElement.scrollHeight ?
  document.documentElement.scrollHeight : document.body.scrollHeight;</span></span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span class='CODE'><span style='font-size:10.0pt'> 
  if (document.body.scrollHeight) sh = Math.max(sh, document.body.scrollHeight)</span></span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span class='CODE'><span style='font-size:10.0pt'> 
  var sw = document.documentElement.scrollWidth ?
  document.documentElement.scrollWidth : document.body.scrollWidth;</span></span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span class='CODE'><span style='font-size:10.0pt'>       
  if(document.body.scrollWidth) sh = Math.max(sh,document.body.scrollWidth)</span></span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span class='CODE'><span style='font-size:10.0pt'>       
  var wh = window.innerHeight ? window.innerHeight : document.body.offsetHeight;</span></span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span class='CODE'><span style='font-size:10.0pt'>       
  var obj = document.getElementById('greyout');</span></span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span class='CODE'><span style='font-size:10.0pt'>       
  obj.style.height = ch+'px';</span></span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span class='CODE'><span style='font-size:10.0pt'>       
  obj.style.width  = cw+'px';</span></span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span class='CODE'><span style='font-size:10.0pt'>       
  obj.style.height = Math.max(wh,Math.max(sh,ch))+'px';</span></span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span class='CODE'><span style='font-size:10.0pt'>       
  obj.style.width  = Math.max(sw,cw)+'px';</span></span></p>

  <p class="MsoNormal"><span class='CODE'><span style='font-size:10.0pt;line-height:
  115%'>      }</span></span></p>

  <p class="MsoNormal">&nbsp;</p>

  <table 
   style='border-collapse:collapse;border:none'>
   <tr>
    <td width='319' valign='top' style='width:239.4pt;padding:0in 5.4pt 0in 5.4pt'>
    <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
    normal'><a name='CSSFormating'><br/><span class='Heading5Char'>CSS Formatting</span><b>.</b>
    Formatting is specified in separate CSS files for cleaner code and easier
    maintenance. Here is a snippet:</a></p>
    <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
    normal'>On the Masterpage is this line of code:</p>
    <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
    normal;'><span style='font-size:10.0pt;font-family:"Courier New";
    color:blue'>&lt;</span><span style='font-size:10.0pt;font-family:"Courier New";
    color:#A31515'>link</span><span style='font-size:10.0pt;font-family:"Courier New"'>
    <span style='color:red'>href</span><span style='color:blue'>=&quot;Style/popup.css&quot;</span>
    <span style='color:red'>rel</span><span style='color:blue'>=&quot;stylesheet&quot;</span>
    <span style='color:red'>type</span><span style='color:blue'>=&quot;text/css&quot;</span>
    <span style='color:blue'>/&gt;</span></span></p>
    <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
    normal;'><span style='font-size:10.0pt;font-family:"Courier New";
    color:blue'>&nbsp;</span></p>
    <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
    normal;'><span style='font-size:10.0pt;font-family:"Courier New";
    color:blue'>&nbsp;</span></p>
    <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
    normal;'><span style='font-size:10.0pt;font-family:"Courier New";
    color:blue'>&nbsp;</span></p>
    <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
    normal'>Which links to this CSS:</p>
    </td>
    <td width='319' valign='top' style='width:239.4pt;padding:0in 5.4pt 0in 5.4pt'>
    <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
    normal'><img alt='' width='244' height='174' src="../Images/VBAProjectsImages/image004.jpg"
    align='left' hspace='12'/></p>
    </td>
   </tr>
  </table>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span style='font-size:10.0pt;font-family:"Courier New";
  color:blue'>&nbsp;</span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span style='font-size:10.0pt;font-family:"Courier New";
  color:#A31515'>body</span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span style='font-size:10.0pt;font-family:"Courier New"'>{</span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span style='font-size:10.0pt;font-family:"Courier New"'> 
  <span style='color:red'>text-decoration</span>: <span style='color:blue'>none</span>;</span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span style='font-size:10.0pt;font-family:"Courier New"'> 
  <span style='color:red'>font-family</span>: <span style='color:blue'>Arial,</span>
  <span style='color:blue'>Helvetica,</span> <span style='color:blue'>sans-serif</span>;</span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span style='font-size:10.0pt;font-family:"Courier New"'> 
  <span style='color:red'>font-size</span>: <span style='color:blue'>small</span>;</span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span style='font-size:10.0pt;font-family:"Courier New"'> 
  <span style='color:red'>font-weight</span>: <span style='color:blue'>normal</span>;</span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span style='font-size:10.0pt;font-family:"Courier New"'> 
  <span style='color:red'>font-style</span>: <span style='color:blue'>normal</span>;</span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span style='font-size:10.0pt;font-family:"Courier New"'> 
  <span style='color:red'>background-color</span>: <span style='color:blue'>#FFFFFF</span>;</span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span style='font-size:10.0pt;font-family:"Courier New"'>}</span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span style='font-size:10.0pt;font-family:"Courier New";
  color:#A31515'>.popup</span><span style='font-size:10.0pt;font-family:"Courier New"'>
  {</span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span style='font-size:10.0pt;font-family:"Courier New"'> 
  <span style='color:red'>border</span>: <span style='color:blue'>outset</span> <span
  style='color:blue'>4px</span> <span style='color:blue'>Gray</span>;</span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span style='font-size:10.0pt;font-family:"Courier New"'> 
  <span style='color:red'>font-family</span>: <span style='color:blue'>Arial,</span>
  <span style='color:blue'>Helvetica,</span> <span style='color:blue'>sans-serif</span>;</span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span style='font-size:10.0pt;font-family:"Courier New"'> 
  <span style='color:red'>font-size</span>: <span style='color:blue'>12px</span>;</span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span style='font-size:10.0pt;font-family:"Courier New"'> 
  <span style='color:red'>display</span>: <span style='color:blue'>none</span>;</span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span style='font-size:10.0pt;font-family:"Courier New"'> 
  <span style='color:red'>position</span>: <span style='color:blue'>fixed</span>;</span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span style='font-size:10.0pt;font-family:"Courier New"'> 
  <span style='color:red'>left</span>: <span style='color:blue'>10px</span>;</span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span style='font-size:10.0pt;font-family:"Courier New"'> 
  <span style='color:red'>top</span>: <span style='color:blue'>50px</span>;</span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span style='font-size:10.0pt;font-family:"Courier New"'> 
  <span style='color:red'>z-index</span>: <span style='color:blue'>100</span>;</span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span style='font-size:10.0pt;font-family:"Courier New"'>}</span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span style='font-size:10.0pt;font-family:"Courier New";
  color:#A31515'>.popuptitle</span><span style='font-size:10.0pt;font-family:
  "Courier New"'> {</span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span style='font-size:10.0pt;font-family:"Courier New"'> 
  <span style='color:red'>background-position</span>: <span style='color:blue'>center</span>;</span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span style='font-size:10.0pt;font-family:"Courier New"'> 
  <span style='color:red'>background</span>: <span style='color:blue'>teal</span>;</span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span style='font-size:10.0pt;font-family:"Courier New"'>  <span
  style='color:red'>color</span>: <span style='color:blue'>black</span>;</span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span style='font-size:10.0pt;font-family:"Courier New"'> 
  <span style='color:red'>font-weight</span>: <span style='color:blue'>bold</span>;</span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span style='font-size:10.0pt;font-family:"Courier New"'> 
  <span style='color:red'>font-size</span>: <span style='color:blue'>12pt</span>;</span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span style='font-size:10.0pt;font-family:"Courier New"'> 
  <span style='color:red'>height</span>: <span style='color:blue'>15px</span>;</span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span style='font-size:10.0pt;font-family:"Courier New"'> 
  <span style='color:red'>padding</span>: <span style='color:blue'>10px</span>;</span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span style='font-size:10.0pt;font-family:"Courier New"'> 
  <span style='color:red'>border-bottom</span>: <span style='color:blue'>solid</span>
  <span style='color:blue'>1px</span> <span style='color:blue'>black</span>;</span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span style='font-size:10.0pt;font-family:"Courier New"'>}</span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span style='font-size:10.0pt;font-family:"Courier New";
  color:#A31515'>.popupbody</span><span style='font-size:10.0pt;font-family:"Courier New"'>
  {</span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span style='font-size:10.0pt;font-family:"Courier New"'> 
  <span style='color:red'>background-position</span>: <span style='color:blue'>inherit</span>;</span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span style='font-size:10.0pt;font-family:"Courier New"'> 
  <span style='color:red'>background</span>: <span style='color:blue'>#ddd</span>;</span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span style='font-size:10.0pt;font-family:"Courier New"'> 
  <span style='color:red'>padding</span>: <span style='color:blue'>10px</span> <span
  style='color:blue'>5px</span> <span style='color:blue'>0px</span> <span
  style='color:blue'>5px</span>;</span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span style='font-size:10.0pt;font-family:"Courier New"'> 
  <span style='color:red'>text-align</span>: <span style='color:blue'>left</span>;</span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span style='font-size:10.0pt;font-family:"Courier New"'> 
  <span style='color:red'>font-family</span>: <span style='color:blue'>Arial,</span>
  <span style='color:blue'>Helvetica,</span> <span style='color:blue'>sans-serif</span>;</span></p>

  <p class="MsoNormal"><span style='font-size:10.0pt;line-height:115%;font-family:
  "Courier New"'>}</span></p>

  <p class="MsoNormal"><a name='FTPAssembly'><br/><span class='Heading5Char'>FTP Assembly</span></a><b>.</b>
  The connection between the website and the Schedule Board in Outlook is through
  a COM assembly build with Visual Studio that provides a TLB for easy
  References. The Visual Studio project uses the Class Library template in VB.
  This template is COM Class that provides a TLB file when compiled with: Compile
  Option- “Register for COM interop” and Assembly Information- “Make assembly
  COM-Visible”, both checked . The FTP functionality is provided by System.Net.FtpWebRequest.
  This code snippet show the procedure: <img alt="" border='0' width='540' height='172'
  id="Picture 10" src="../Images/VBAProjectsImages/image005.jpg"/></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span style='font-size:10.0pt;font-family:"Courier New"'> <span
  style='color:blue'>Public</span> <span style='color:blue'>Sub</span>
  ftpDownloadWebRequest(<span style='color:blue'>ByVal</span> path <span
  style='color:blue'>As</span> <span style='color:blue'>String</span>, <span
  style='color:blue'>ByVal</span> name <span style='color:blue'>As</span> <span
  style='color:blue'>String</span>)</span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span style='font-size:10.0pt;font-family:"Courier New"'>       
  <span style='color:blue'>Dim</span> localFile <span style='color:blue'>As</span>
  <span style='color:blue'>String</span></span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span style='font-size:10.0pt;font-family:"Courier New"'>       
  localFile = path &amp; name</span></p>

  <p class='MsoNormal' style='margin-top:0in;margin-right:0in;margin-bottom:0in;
  margin-left:.5in;margin-bottom:.0001pt;line-height:normal;'><span
  style='font-size:10.0pt;font-family:"Courier New";color:blue'>  Const</span><span
  style='font-size:10.0pt;font-family:"Courier New"'> remoteFile <span
  style='color:blue'>As</span> <span style='color:blue'>String</span> =    <span
  style='color:#A31515'>&quot;/gooddaycorp.com/wwwroot/App_Data/calendar.xls&quot;</span></span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span style='font-size:10.0pt;font-family:"Courier New"'>       
  <span style='color:blue'>Const</span> host <span style='color:blue'>As</span> <span
  style='color:blue'>String</span> = <span style='color:#A31515'>&quot;ftp://xxxxxxxxxx@xxx.xxx.xxx.xxx&quot;</span></span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span style='font-size:10.0pt;font-family:"Courier New"'>       
  <span style='color:blue'>Const</span> username <span style='color:blue'>As</span>
  <span style='color:blue'>String</span> = <span style='color:#A31515'>&quot;xxxxxxxxxxx&quot;</span></span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span style='font-size:10.0pt;font-family:"Courier New"'>       
  <span style='color:blue'>Const</span> password <span style='color:blue'>As</span>
  <span style='color:blue'>String</span> = <span style='color:#A31515'>&quot;xxxxxxxxxxx&quot;</span></span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span style='font-size:10.0pt;font-family:"Courier New";
  color:#A31515'>&nbsp;</span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span style='font-size:10.0pt;font-family:"Courier New"'>       
  <span style='color:green'>'1. Create a request: must be in ftp://hostname
  format, </span></span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span style='font-size:10.0pt;font-family:"Courier New"'>       
  <span style='color:green'>'   not just ftp.myhost.com</span></span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span style='font-size:10.0pt;font-family:"Courier New"'>       
  <span style='color:blue'>Dim</span> URI <span style='color:blue'>As</span> <span
  style='color:blue'>String</span> = host &amp; remoteFile</span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span style='font-size:10.0pt;font-family:"Courier New"'>       
  <span style='color:blue'>Dim</span> ftp <span style='color:blue'>As</span>
  System.Net.FtpWebRequest = _</span></p>

  <p class='MsoNormal' style='margin-top:0in;margin-right:0in;margin-bottom:0in;
  margin-left:1.0in;margin-bottom:.0001pt;line-height:normal;'><span
  style='font-size:10.0pt;font-family:"Courier New";color:blue'>CType</span><span
  style='font-size:10.0pt;font-family:"Courier New"'>(System.Net.FtpWebRequest.Create(URI),
  _ System.Net.FtpWebRequest)</span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span style='font-size:10.0pt;font-family:"Courier New"'>&nbsp;</span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span style='font-size:10.0pt;font-family:"Courier New"'>       
  <span style='color:green'>'2. Set credentials</span></span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span style='font-size:10.0pt;font-family:"Courier New"'>       
  ftp.Credentials = <span style='color:blue'>New</span>  _</span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span style='font-size:10.0pt;font-family:"Courier New"'>   
          System.Net.NetworkCredential(username, password)</span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span style='font-size:10.0pt;font-family:"Courier New"'>&nbsp;</span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span style='font-size:10.0pt;font-family:"Courier New"'>       
  <span style='color:green'>'3. Settings and action</span></span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span style='font-size:10.0pt;font-family:"Courier New"'>       
  ftp.KeepAlive = <span style='color:blue'>False</span></span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span style='font-size:10.0pt;font-family:"Courier New"'>       
  <span style='color:green'>'we want a binary transfer, not textual data</span></span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span style='font-size:10.0pt;font-family:"Courier New"'>       
  ftp.UseBinary = <span style='color:blue'>True</span></span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span style='font-size:10.0pt;font-family:"Courier New"'>       
  <span style='color:green'>'Define the action required (in this case, download a
  file)</span></span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span style='font-size:10.0pt;font-family:"Courier New"'>       
  ftp.Method = System.Net.WebRequestMethods.Ftp.DownloadFile</span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span style='font-size:10.0pt;font-family:"Courier New"'>&nbsp;</span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span style='font-size:10.0pt;font-family:"Courier New"'>       
  <span style='color:green'>'4. If we were using a method that uploads data e.g.
  UploadFile</span></span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span style='font-size:10.0pt;font-family:"Courier New"'>       
  <span style='color:green'>'   we would open the ftp.GetRequestStream here an
  send the data</span></span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span style='font-size:10.0pt;font-family:"Courier New";
  color:green'>&nbsp;</span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span style='font-size:10.0pt;font-family:"Courier New"'>       
  <span style='color:green'>'5. Get the response to the Ftp request and the
  associated stream</span></span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span style='font-size:10.0pt;font-family:"Courier New"'>       
  <span style='color:blue'>Using</span> response <span style='color:blue'>As</span>
  System.Net.FtpWebResponse = _</span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span style='font-size:10.0pt;font-family:"Courier New"'>             
  <span style='color:blue'>CType</span>(ftp.GetResponse,
  System.Net.FtpWebResponse)</span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span style='font-size:10.0pt;font-family:"Courier New"'>           
  <span style='color:blue'>Using</span> responseStream <span style='color:blue'>As</span>
  IO.Stream = response.GetResponseStream</span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span style='font-size:10.0pt;font-family:"Courier New"'>              
   <span style='color:green'>'loop to read &amp; write to file</span></span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span style='font-size:10.0pt;font-family:"Courier New"'>               
  <span style='color:blue'>Using</span> fs <span style='color:blue'>As</span> <span
  style='color:blue'>New</span> IO.FileStream(localFile, IO.FileMode.Create)</span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span style='font-size:10.0pt;font-family:"Courier New"'>                   
  <span style='color:blue'>Dim</span> buffer(2047) <span style='color:blue'>As</span>
  <span style='color:blue'>Byte</span></span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span style='font-size:10.0pt;font-family:"Courier New"'>                   
  <span style='color:blue'>Dim</span> read <span style='color:blue'>As</span> <span
  style='color:blue'>Integer</span> = 0</span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span style='font-size:10.0pt;font-family:"Courier New"'>                   
  <span style='color:blue'>Do</span></span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span style='font-size:10.0pt;font-family:"Courier New"'>                       
  read = responseStream.Read(buffer, 0, buffer.Length)</span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span style='font-size:10.0pt;font-family:"Courier New"'>                       
  fs.Write(buffer, 0, read)</span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span style='font-size:10.0pt;font-family:"Courier New"'>                       
  <span style='color:green'>'downloadForm.ProgressBar1.PerformStep()</span></span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span style='font-size:10.0pt;font-family:"Courier New"'>                  
  <span style='color:blue'>Loop</span> <span style='color:blue'>Until</span> read
  = 0 <span style='color:green'>'see Note(1)</span></span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span style='font-size:10.0pt;font-family:"Courier New"'>                   
  responseStream.Close()</span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span style='font-size:10.0pt;font-family:"Courier New"'>    
                 fs.Flush()</span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span style='font-size:10.0pt;font-family:"Courier New"'>                   
  fs.Close()</span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span style='font-size:10.0pt;font-family:"Courier New"'>               
  <span style='color:blue'>End</span> <span style='color:blue'>Using</span></span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span style='font-size:10.0pt;font-family:"Courier New"'>               
  responseStream.Close()</span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span style='font-size:10.0pt;font-family:"Courier New"'>           
  <span style='color:blue'>End</span> <span style='color:blue'>Using</span></span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span style='font-size:10.0pt;font-family:"Courier New"'>           
  response.Close()</span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span style='font-size:10.0pt;font-family:"Courier New"'>       
  <span style='color:blue'>End</span> <span style='color:blue'>Using</span></span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span style='font-size:10.0pt;font-family:"Courier New";
  color:blue'>&nbsp;</span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span style='font-size:10.0pt;font-family:"Courier New"'>   
  MsgBox(<span style='color:#A31515'>&quot;Download Complete&quot;</span>)</span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span style='font-size:10.0pt;font-family:"Courier New"'>   
  <span style='color:green'>'downloadForm.ProgressBar1.Value = 0</span></span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span style='font-size:10.0pt;font-family:"Courier New"'>       
  <span style='color:green'>'6. Done! the Close happens because ftp goes out of
  scope</span></span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span style='font-size:10.0pt;font-family:"Courier New"'>       
  <span style='color:green'>'   There is no .Close or .Dispose for FtpWebRequest</span></span></p>

  <p class='MsoNormal' style='margin-bottom:0in;margin-bottom:.0001pt;line-height:
  normal;'><span style='font-size:10.0pt;font-family:"Courier New"'>   
  <span style='color:blue'>End</span> <span style='color:blue'>Sub</span></span></p>

  <p class="MsoNormal">&nbsp;</p>

  <p class="MsoNormal">&nbsp;</p>

  </div>
</asp:Content>
<asp:Content ID="Content4" ContentPlaceHolderID="footercontent" Runat="Server">
</asp:Content>

